name: Preview readme files on PRs
on:
  pull_request:
    paths: '**/README.md'

jobs:
  preview-readme:
    permissions:
      pull-requests: write
    runs-on: ubuntu-latest
    steps:
        - name: Checkout code
          uses: actions/checkout@v4
        - name: Preview readmes
          run: |
            python -m pip install --upgrade pip
            pip install -r testing-requirements.txt
            make readme-preview
#        - uses: actions/upload-artifact@v4
#          id: collection-readme
#          with:
#            name: collection-readme
#            path: README.html
#        - uses: actions/upload-artifact@v4
#          id: role-readme
#          with:
#            name: role-readme
#            path: roles/tas_single_node/README.html
        - uses: mshick/add-pr-comment@v2
          with:
            message-path: |
              README.html
